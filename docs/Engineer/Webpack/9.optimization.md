---
title: 性能优化
---

性能优化可以分为两块。

一块是通过`webpack`优化项目打包，进而提升项目性能。这一部分大致有`splitChunks`、`DLL`以及`gzip`等。

另一块则是通过配置项或插件对`webpack`的打包过程进行检测优化。

## 1.splitChunksPlugin

## 2.DLL

## 3.gzip

将资源进行`gzip`压缩后，体积更小，传输效率更高。通常情况下是由服务端譬如`nginx`将资源进行压缩并返回给客户端，然后浏览器解析`gzip`压缩后的文件。目前主流浏览器均已支持`gzip`压缩。

在`webpack`中设置`gzip`，主要是为了将资源提前压缩，这样在部署后就可以降低`nginx`的消耗，提升网站响应效率。

在`webpack`需要使用`compression-webpack-plugin`插件，将资源进行压缩。核心配置如下：

```js
const CompressionWebpackPlugin = require('compression-webpack-plugin')

module.exports = {
  plugins: [
    new CompressionWebpackPlugin({
      // 压缩后的文件命名 默认为'[path].[base].gz'
      filename: '[path].[base].gz',
      // 采用的压缩算法
      algorithm: 'gzip',
      // 目标资源
      test: /\.(js|css)$/,
      // 阈值 大于该值的文件才会经历压缩 这里设置成1024b
      thresold: 10240,
      // 压缩比例 1-10 数值越大 压缩效果越好 但也会更加耗时
      minRatio: 8,
      // 压缩文件后 是否删除源文件 默认不删除
      deleteOriginalAssets: true
    })
  ]
}
```

当我们使用`compression-webpack-plugin`进行压缩后，在部署时还需要`nginx`的配合。常见配置如下：

```nginx
#开启gzip压缩 on开启 off关闭
gzip on;
#开启nginx_static后，对于任何文件都会先查找是否有对应的gz文件。如果有，直接使用，nginx不再对该文件gzip。
gzip_static on;
gzip_min_length 1k;
gzip_buffers 4 32k;
gzip_http_version 1.1;
gzip_comp_level 2;
gzip_types text/plain application/x-javascript text/css application/xml;
gzip_vary on;
gzip_disable "MSIE [1-6]."
```

