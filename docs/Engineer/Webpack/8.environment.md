---
title: 环境
---

## 1.mode

`webpack4.0`增加了`mode`选项。以此来标明`webpack`在执行时使用相应模式的内置优化。

`mode`有两个值:`development`、`production`。如果不设置`mode`的话，`webpack`默认采用`mode`为`production`。

两种配置方法：

- 在相应的配置文件中直接设置。

  ```js
  module.exports = {
    mode: 'development' // or 'production'
  }
  ```

- 通过`CLI`参数传递。
  
  ```shell
  webpack --mode=development --config webpack.config.js
  ```

在设置`mode`为`development`或`production`后，`Node`环境下的变量`process.env.NODE_ENV`也会对应设置为`development`或`production`。

另外，在`mode`的两种模式下，`webpack`会启用内置的不同插件。

## 2.mode: development

默认启用`NamedModulesPlugin`和`NamedChunksPlugin`。这两插件是为了保证`module id`与`chunk id`的稳定。

```js
// webpack.dev.config.js
module.exports = {
+ mode: 'development'
- plugins: [
-   new webpack.NamedModulesPlugin(),
-   new webpack.NamedChunksPlugin()
-   new webpack.DefinePlugin({ "process.env.NODE_ENV": JSON.stringify("development") }),
- ]
}
```

## 3.mode: production

默认启用`FlagDependencyUsagePlugin`、`FlagIncludedChunksPlugin`、`ModuleConcatenationPlugin`、`NoEmitOnErrorsPlugin`、`OccurrenceOrderPlugin`、`SideEffectsFlagPlugin`以及`UglifyJsPlugin`。

```js
// webpack.production.config.js
module.exports = {
+  mode: 'production',
-  plugins: [
-    new UglifyJsPlugin(/* ... */),
-    new webpack.DefinePlugin({ "process.env.NODE_ENV": JSON.stringify("production") }),
-    new webpack.optimize.ModuleConcatenationPlugin(),
-    new webpack.NoEmitOnErrorsPlugin()
-  ]
}
```
